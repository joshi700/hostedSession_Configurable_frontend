{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\gaura\\\\Downloads\\\\FINAL-hosted-session-with-3DS\\\\final-integrated-version\\\\frontend\\\\src\\\\CreditCardDetails.js\",\n  _s = $RefreshSig$();\nimport React, { useRef, useState, useEffect } from 'react';\nimport axios from 'axios';\nimport ApiLogger from './ApiLogger';\nimport apiLogManager from './utils/ApiLogManager'; // ← ADDED: Import ApiLogManager\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CreditCardDetails = ({\n  message,\n  sendDataToParent,\n  sendDataToParentsessionid,\n  sendDataToParentorderId,\n  sendDataToParenttrxid,\n  onApiLog\n}) => {\n  _s();\n  const cardNumberRef = useRef(null);\n  const expiryMonthRef = useRef(null);\n  const expiryYearRef = useRef(null);\n  const securityCodeRef = useRef(null);\n  const cardholderNameRef = useRef(null);\n  const [showAuthComponent, setShowAuthComponent] = useState(0);\n  const [sessionId, setSessionId] = useState('');\n  const [orderId, setOrderId] = useState('');\n  const [transactionId, setTransactionId] = useState('');\n  const [merchantConfig, setMerchantConfig] = useState(null);\n  const [apiLogs, setApiLogs] = useState([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [currentStep, setCurrentStep] = useState(0); // Track 3DS flow step\n  const [processingStep, setProcessingStep] = useState(''); // Current processing step\n\n  const sessionCreatedRef = useRef(false); // ← ADDED: Prevent duplicate session creation\n\n  // ← ADDED: API logging handler\n  const handleApiLog = logEntry => {\n    apiLogManager.addLog(logEntry);\n    setApiLogs(prev => [...prev, logEntry]);\n  };\n  useEffect(() => {\n    // ✅ Prevent duplicate session creation\n    if (sessionCreatedRef.current) {\n      console.log('Session already created, skipping...');\n      return;\n    }\n\n    // Load merchant config\n    const saved = localStorage.getItem('merchantConfig');\n    if (!saved) {\n      setError('Merchant configuration not found. Please configure your merchant details.');\n      setIsLoading(false);\n      return;\n    }\n    const config = JSON.parse(saved);\n    setMerchantConfig(config);\n\n    // Load Payment Session script dynamically\n    loadPaymentSessionScript(config);\n\n    // ✅ Mark as created before calling\n    sessionCreatedRef.current = true;\n\n    // Create payment session\n    createPaymentSession(config);\n  }, []); // ← CHANGED: Empty dependency array to run only once\n\n  const loadPaymentSessionScript = config => {\n    // Check if script already exists\n    const existingScript = document.querySelector('script[data-payment-session]');\n    if (existingScript) {\n      existingScript.remove();\n    }\n\n    // Create script URL based on merchant config\n    const scriptUrl = `${config.gatewayUrl}/form/version/${config.apiVersion}/merchant/${config.merchantId}/session.js`;\n    const script = document.createElement('script');\n    script.src = scriptUrl;\n    script.setAttribute('data-payment-session', 'true');\n    script.async = true;\n    script.onload = () => {\n      console.log('Payment Session script loaded successfully');\n    };\n    script.onerror = () => {\n      console.error('Failed to load Payment Session script');\n      setError('Failed to load Payment Session script. Please check your merchant configuration.');\n    };\n    document.head.appendChild(script);\n  };\n  const createPaymentSession = async config => {\n    // ✅ Check if session already exists\n    if (sessionId) {\n      console.log('Session already exists:', sessionId);\n      return;\n    }\n    setIsLoading(true);\n    setError(null);\n    setProcessingStep('Creating session...');\n    try {\n      const requestData = {\n        merchantConfig: config,\n        amount: message,\n        currency: config.currency\n      };\n      const response = await axios.post('http://localhost:3001/create-session', requestData);\n      console.log('Session created:', response.data);\n      setSessionId(response.data.sessionid);\n      setOrderId(response.data.orderid);\n      setTransactionId(response.data.trxid);\n\n      // ← UPDATED: Add API log to both state and ApiLogManager\n      if (response.data.apiLog) {\n        handleApiLog(response.data.apiLog);\n      }\n\n      // Wait for Payment Session script to be available\n      waitForPaymentSession(() => {\n        // Initialize hosted session - pass merchantConfig\n        initiateHostedSession(response.data.sessionid, response.data.orderid, response.data.trxid, config);\n      });\n      setShowAuthComponent(1);\n      sendDataToParentsessionid(response.data.sessionid);\n      sendDataToParentorderId(response.data.orderid);\n      sendDataToParenttrxid(response.data.trxid);\n      setProcessingStep('');\n      setIsLoading(false);\n    } catch (error) {\n      var _error$response, _error$response$data, _error$response2, _error$response2$data;\n      console.error('Failed to create session:', error);\n      setError(((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.details) || error.message);\n\n      // ← UPDATED: Add error log to both state and ApiLogManager\n      if ((_error$response2 = error.response) !== null && _error$response2 !== void 0 && (_error$response2$data = _error$response2.data) !== null && _error$response2$data !== void 0 && _error$response2$data.apiLog) {\n        handleApiLog(error.response.data.apiLog);\n      }\n      setProcessingStep('');\n      setIsLoading(false);\n    }\n  };\n  const waitForPaymentSession = (callback, attempts = 0) => {\n    if (window.PaymentSession) {\n      callback();\n    } else if (attempts < 50) {\n      // Try again in 100ms (max 5 seconds)\n      setTimeout(() => waitForPaymentSession(callback, attempts + 1), 100);\n    } else {\n      setError('Payment Session script failed to load. Please refresh the page.');\n      setIsLoading(false);\n    }\n  };\n\n  // ============================================\n  // 3DS FLOW - STEP 1: INITIATE AUTHENTICATION\n  // ============================================\n  const initiateAuthentication = async (sessionId, orderId, transactionId, configToUse) => {\n    setProcessingStep('Step 1: Checking 3DS availability...');\n    setCurrentStep(1);\n    try {\n      const requestData = {\n        merchantConfig: configToUse,\n        sessionId,\n        orderId,\n        transactionId\n      };\n      console.log('[STEP 1] Initiating authentication...');\n      const response = await axios.post('http://localhost:3001/api/initiate-authentication', requestData);\n      console.log('[STEP 1] Response:', response.data);\n\n      // ← UPDATED: Add API log to both state and ApiLogManager\n      if (response.data.apiLog) {\n        handleApiLog(response.data.apiLog);\n      }\n      const authStatus = response.data.authenticationStatus;\n      const gatewayRecommendation = response.data.gatewayRecommendation;\n      console.log('[STEP 1] Auth Status:', authStatus);\n      console.log('[STEP 1] Gateway Recommendation:', gatewayRecommendation);\n\n      // Check if we should proceed to Step 2 (Authenticate Payer)\n      if (authStatus === 'AUTHENTICATION_AVAILABLE' || gatewayRecommendation === 'PROCEED') {\n        console.log('[STEP 1] 3DS available, proceeding to authenticate payer...');\n        await authenticatePayer(sessionId, orderId, transactionId, configToUse);\n      } else if (authStatus === 'AUTHENTICATION_NOT_AVAILABLE') {\n        console.log('[STEP 1] 3DS not available, skipping to payment...');\n        await authorizePay(sessionId, orderId, transactionId, configToUse);\n      } else {\n        console.log('[STEP 1] Proceeding to Step 2 with status:', authStatus);\n        await authenticatePayer(sessionId, orderId, transactionId, configToUse);\n      }\n    } catch (error) {\n      var _error$response3, _error$response3$data, _error$response4, _error$response4$data;\n      console.error('[STEP 1] Error:', error);\n\n      // ← UPDATED: Add error log to both state and ApiLogManager\n      if ((_error$response3 = error.response) !== null && _error$response3 !== void 0 && (_error$response3$data = _error$response3.data) !== null && _error$response3$data !== void 0 && _error$response3$data.apiLog) {\n        handleApiLog(error.response.data.apiLog);\n      }\n      setProcessingStep('');\n      setError(`Step 1 failed: ${((_error$response4 = error.response) === null || _error$response4 === void 0 ? void 0 : (_error$response4$data = _error$response4.data) === null || _error$response4$data === void 0 ? void 0 : _error$response4$data.details) || error.message}`);\n    }\n  };\n\n  // ============================================\n  // 3DS FLOW - STEP 2: AUTHENTICATE PAYER\n  // ============================================\n  const authenticatePayer = async (sessionId, orderId, transactionId, configToUse) => {\n    setProcessingStep('Step 2: Authenticating payer...');\n    setCurrentStep(2);\n    try {\n      const requestData = {\n        merchantConfig: configToUse,\n        sessionId,\n        orderId,\n        transactionId,\n        amount: message,\n        redirectResponseUrl: `${window.location.origin}/authentication-callback`\n      };\n      console.log('[STEP 2] Authenticating payer...');\n      const response = await axios.post('http://localhost:3001/api/authenticate-payer', requestData);\n      console.log('[STEP 2] Response:', response.data);\n\n      // ← UPDATED: Add API log to both state and ApiLogManager\n      if (response.data.apiLog) {\n        handleApiLog(response.data.apiLog);\n      }\n      const redirectHtml = response.data.redirectHtml;\n      const authStatus = response.data.authenticationStatus;\n      console.log('[STEP 2] Auth Status:', authStatus);\n      console.log('[STEP 2] Has redirect HTML:', !!redirectHtml);\n      if (redirectHtml) {\n        console.log('[STEP 2] 3DS challenge required, showing authentication frame...');\n        sendDataToParent(redirectHtml);\n        sendDataToParentsessionid(sessionId);\n        sendDataToParentorderId(orderId);\n        sendDataToParenttrxid(transactionId);\n        setProcessingStep('Waiting for 3DS authentication...');\n      } else {\n        console.log('[STEP 2] No 3DS challenge needed, proceeding to payment...');\n        await authorizePay(sessionId, orderId, transactionId, configToUse);\n      }\n    } catch (error) {\n      var _error$response5, _error$response5$data, _error$response6, _error$response6$data;\n      console.error('[STEP 2] Error:', error);\n\n      // ← UPDATED: Add error log to both state and ApiLogManager\n      if ((_error$response5 = error.response) !== null && _error$response5 !== void 0 && (_error$response5$data = _error$response5.data) !== null && _error$response5$data !== void 0 && _error$response5$data.apiLog) {\n        handleApiLog(error.response.data.apiLog);\n      }\n      setProcessingStep('');\n      setError(`Step 2 failed: ${((_error$response6 = error.response) === null || _error$response6 === void 0 ? void 0 : (_error$response6$data = _error$response6.data) === null || _error$response6$data === void 0 ? void 0 : _error$response6$data.details) || error.message}`);\n    }\n  };\n\n  // ============================================\n  // 3DS FLOW - STEP 3: AUTHORIZE/PAY\n  // ============================================\n  const authorizePay = async (sessionId, orderId, transactionId, configToUse) => {\n    setProcessingStep('Step 3: Processing payment...');\n    setCurrentStep(3);\n    try {\n      const requestData = {\n        merchantConfig: configToUse,\n        sessionId,\n        orderId,\n        transactionId\n      };\n      console.log('[STEP 3] Authorizing payment...');\n      const response = await axios.post('http://localhost:3001/api/authorize-pay', requestData);\n      console.log('[STEP 3] Response:', response.data);\n\n      // ← UPDATED: Add API log to both state and ApiLogManager\n      if (response.data.apiLog) {\n        handleApiLog(response.data.apiLog);\n      }\n      const result = response.data.result;\n      const gatewayCode = response.data.gatewayCode;\n      console.log('[STEP 3] Result:', result);\n      console.log('[STEP 3] Gateway Code:', gatewayCode);\n      setProcessingStep('');\n      if (result === 'SUCCESS') {\n        console.log('[STEP 3] Payment successful!');\n        // Handle success (e.g., redirect to receipt page)\n      } else {\n        console.log('[STEP 3] Payment not successful:', result);\n        setError(`Payment failed: ${result}`);\n      }\n    } catch (error) {\n      var _error$response7, _error$response7$data, _error$response8, _error$response8$data;\n      console.error('[STEP 3] Error:', error);\n\n      // ← UPDATED: Add error log to both state and ApiLogManager\n      if ((_error$response7 = error.response) !== null && _error$response7 !== void 0 && (_error$response7$data = _error$response7.data) !== null && _error$response7$data !== void 0 && _error$response7$data.apiLog) {\n        handleApiLog(error.response.data.apiLog);\n      }\n      setProcessingStep('');\n      setError(`Step 3 failed: ${((_error$response8 = error.response) === null || _error$response8 === void 0 ? void 0 : (_error$response8$data = _error$response8.data) === null || _error$response8$data === void 0 ? void 0 : _error$response8$data.details) || error.message}`);\n    }\n  };\n  const initiateHostedSession = (sessionId, orderId, transactionId, config) => {\n    // Wait for DOM elements to be ready\n    const checkAndInitialize = (attempts = 0) => {\n      if (attempts > 20) {\n        console.error('Timeout waiting for DOM elements');\n        setError('Failed to initialize payment fields. Please refresh the page.');\n        setIsLoading(false);\n        return;\n      }\n\n      // Check if all required DOM elements exist\n      const cardNumber = document.getElementById('card-number');\n      const securityCode = document.getElementById('security-code');\n      const expiryMonth = document.getElementById('expiry-month');\n      const expiryYear = document.getElementById('expiry-year');\n      const cardholderName = document.getElementById('cardholder-name');\n      if (!cardNumber || !securityCode || !expiryMonth || !expiryYear || !cardholderName) {\n        console.log(`Attempt ${attempts + 1}: Waiting for DOM elements...`);\n        setTimeout(() => checkAndInitialize(attempts + 1), 100);\n        return;\n      }\n\n      // DOM elements are ready, now configure Payment Session\n      try {\n        if (!window.PaymentSession) {\n          console.error('PaymentSession not available');\n          setError('Payment Session not loaded. Please refresh the page.');\n          setIsLoading(false);\n          return;\n        }\n        console.log('✅ All DOM elements found, configuring Payment Session...');\n        console.log('Configuring Payment Session with session:', sessionId);\n        console.log('Using config:', config ? 'Present' : 'Missing');\n        window.PaymentSession.configure({\n          session: sessionId,\n          fields: {\n            card: {\n              number: \"#card-number\",\n              securityCode: \"#security-code\",\n              expiryMonth: \"#expiry-month\",\n              expiryYear: \"#expiry-year\",\n              nameOnCard: \"#cardholder-name\"\n            }\n          },\n          frameEmbeddingMitigation: [\"javascript\"],\n          callbacks: {\n            initialized: function (response) {\n              console.log('Payment session initialized successfully:', response);\n              if (response.status === 'system_error' || response.status === 'fields_in_error') {\n                console.error('Payment Session initialization error:', response);\n                setError(`Payment field error: ${response.message || 'Unknown error'}`);\n                setIsLoading(false);\n              }\n            },\n            formSessionUpdate: function (response) {\n              console.log('Form session updated, starting 3DS flow...', response);\n              if (response.status === 'ok' && response.session) {\n                // Start the 3DS flow\n                initiateAuthentication(sessionId, orderId, transactionId, config);\n              } else if (response.status === 'system_error' || response.status === 'request_timeout') {\n                console.error('Form session update error:', response);\n                setError(`Session update failed: ${response.message || response.status}`);\n                setProcessingStep('');\n              } else {\n                console.error('Invalid form session update response:', response);\n                setError('Failed to update session. Please try again.');\n                setProcessingStep('');\n              }\n            }\n          },\n          interaction: {\n            displayControl: {\n              formatCard: \"EMBOSSED\",\n              invalidFieldCharacters: \"REJECT\"\n            }\n          }\n        });\n      } catch (error) {\n        console.error('Error configuring Payment Session:', error);\n        setError('Failed to configure payment session. Please try again.');\n        setIsLoading(false);\n      }\n    };\n\n    // Start checking for DOM elements\n    checkAndInitialize();\n  };\n  const handlePayClicked = () => {\n    if (window.PaymentSession) {\n      window.PaymentSession.updateSessionFromForm('card');\n    } else {\n      setError('Payment session not initialized. Please refresh the page.');\n    }\n  };\n\n  // Loading state\n  if (isLoading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: styles.wrapper,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        style: styles.container,\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          style: styles.loadingContainer,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: styles.spinner\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 432,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            style: styles.loadingText,\n            children: processingStep || 'Initializing payment...'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 433,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 431,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 430,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 429,\n      columnNumber: 7\n    }, this);\n  }\n\n  // Error state\n  if (error && !sessionId) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: styles.wrapper,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        style: styles.container,\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          style: styles.errorContainer,\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            style: styles.errorTitle,\n            children: \"Configuration Error\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 446,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            style: styles.errorText,\n            children: error\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 447,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            style: styles.configButton,\n            onClick: () => window.location.href = '/config',\n            children: \"Go to Configuration\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 448,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 445,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 444,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 443,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: styles.wrapper,\n    children: [sessionId && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: styles.sessionDetails,\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        style: styles.sessionTitle,\n        children: \"Session Information\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 465,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: styles.detailRow,\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          style: styles.detailLabel,\n          children: \"Session ID:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 467,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"code\", {\n          style: styles.detailValue,\n          children: sessionId\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 468,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 466,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: styles.detailRow,\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          style: styles.detailLabel,\n          children: \"Order ID:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 471,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"code\", {\n          style: styles.detailValue,\n          children: orderId\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 472,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 470,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: styles.detailRow,\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          style: styles.detailLabel,\n          children: \"Transaction ID:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 475,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"code\", {\n          style: styles.detailValue,\n          children: transactionId\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 476,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 474,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 464,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: styles.container,\n      children: [processingStep && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: styles.stepIndicator,\n        children: processingStep\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 484,\n        columnNumber: 11\n      }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: styles.errorBanner,\n        children: [\"\\u26A0\\uFE0F \", error]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 490,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n        style: styles.heading,\n        children: \"Payment Details\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 495,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: styles.formGroup,\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          style: styles.label,\n          children: \"Card Number\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 498,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          ref: cardNumberRef,\n          id: \"card-number\",\n          type: \"text\",\n          placeholder: \"1234 5678 9012 3456\",\n          readOnly: true,\n          style: styles.input\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 499,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 497,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: styles.formRow,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: styles.formGroup,\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            style: styles.label,\n            children: \"Expiry Month\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 511,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            ref: expiryMonthRef,\n            id: \"expiry-month\",\n            type: \"text\",\n            placeholder: \"MM\",\n            readOnly: true,\n            style: styles.input\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 512,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 510,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: styles.formGroup,\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            style: styles.label,\n            children: \"Expiry Year\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 523,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            ref: expiryYearRef,\n            id: \"expiry-year\",\n            type: \"text\",\n            placeholder: \"YY\",\n            readOnly: true,\n            style: styles.input\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 524,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 522,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 509,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: styles.formGroup,\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          style: styles.label,\n          children: \"Security Code\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 536,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          ref: securityCodeRef,\n          id: \"security-code\",\n          type: \"text\",\n          placeholder: \"123\",\n          readOnly: true,\n          style: styles.input\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 537,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 535,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: styles.formGroup,\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          style: styles.label,\n          children: \"Cardholder Name\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 548,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          ref: cardholderNameRef,\n          id: \"cardholder-name\",\n          type: \"text\",\n          placeholder: \"John Doe\",\n          readOnly: true,\n          style: styles.input\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 549,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 547,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        style: processingStep ? styles.payButtonDisabled : styles.payButton,\n        onClick: handlePayClicked,\n        disabled: !!processingStep,\n        children: processingStep ? 'Processing...' : `Pay $${message} ${merchantConfig === null || merchantConfig === void 0 ? void 0 : merchantConfig.currency}`\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 559,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: styles.securityNote,\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          style: styles.lockIcon,\n          children: \"\\uD83D\\uDD12\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 568,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          style: styles.securityText,\n          children: \"Secured by Mastercard Payment Gateway\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 569,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 567,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 482,\n      columnNumber: 7\n    }, this), apiLogs.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: styles.apiLoggerContainer,\n      children: /*#__PURE__*/_jsxDEV(ApiLogger, {\n        apiLogs: apiLogs,\n        title: \"API Call Logs\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 576,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 575,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 461,\n    columnNumber: 5\n  }, this);\n};\n_s(CreditCardDetails, \"x4bLi06y/9FJjhZBF7RRbMYDyAI=\");\n_c = CreditCardDetails;\nconst styles = {\n  wrapper: {\n    width: '100%',\n    maxWidth: '800px',\n    margin: '0 auto'\n  },\n  container: {\n    backgroundColor: '#fff',\n    borderRadius: '12px',\n    padding: '30px',\n    marginBottom: '20px',\n    boxShadow: '0 2px 12px rgba(0,0,0,0.08)'\n  },\n  loadingContainer: {\n    textAlign: 'center',\n    padding: '40px'\n  },\n  spinner: {\n    border: '3px solid #f3f3f3',\n    borderTop: '3px solid #0071e3',\n    borderRadius: '50%',\n    width: '40px',\n    height: '40px',\n    animation: 'spin 1s linear infinite',\n    margin: '0 auto 20px'\n  },\n  loadingText: {\n    color: '#86868b',\n    fontSize: '1rem'\n  },\n  errorContainer: {\n    textAlign: 'center',\n    padding: '40px'\n  },\n  errorTitle: {\n    color: '#ff3b30',\n    fontSize: '1.5rem',\n    marginBottom: '16px'\n  },\n  errorText: {\n    color: '#1d1d1f',\n    fontSize: '1rem',\n    marginBottom: '24px'\n  },\n  errorBanner: {\n    backgroundColor: '#fff5f5',\n    color: '#ff3b30',\n    padding: '12px 16px',\n    borderRadius: '8px',\n    marginBottom: '20px',\n    border: '1px solid #ffdddd'\n  },\n  configButton: {\n    padding: '12px 24px',\n    backgroundColor: '#0071e3',\n    color: '#fff',\n    border: 'none',\n    borderRadius: '8px',\n    fontSize: '1rem',\n    cursor: 'pointer'\n  },\n  sessionDetails: {\n    backgroundColor: '#f5f5f7',\n    borderRadius: '12px',\n    padding: '20px',\n    marginBottom: '20px'\n  },\n  sessionTitle: {\n    fontSize: '1.1rem',\n    fontWeight: '600',\n    color: '#1d1d1f',\n    marginBottom: '16px'\n  },\n  detailRow: {\n    display: 'flex',\n    justifyContent: 'space-between',\n    padding: '8px 0',\n    borderBottom: '1px solid #e5e5e7'\n  },\n  detailLabel: {\n    fontSize: '0.9rem',\n    color: '#86868b',\n    fontWeight: '500'\n  },\n  detailValue: {\n    fontSize: '0.85rem',\n    fontFamily: 'Monaco, Courier, monospace',\n    backgroundColor: '#fff',\n    padding: '4px 8px',\n    borderRadius: '4px',\n    color: '#1d1d1f'\n  },\n  heading: {\n    fontSize: '1.5rem',\n    fontWeight: '600',\n    color: '#1d1d1f',\n    marginBottom: '24px',\n    textAlign: 'center'\n  },\n  formGroup: {\n    marginBottom: '20px'\n  },\n  formRow: {\n    display: 'grid',\n    gridTemplateColumns: '1fr 1fr',\n    gap: '16px'\n  },\n  label: {\n    display: 'block',\n    fontSize: '0.95rem',\n    fontWeight: '500',\n    color: '#1d1d1f',\n    marginBottom: '8px'\n  },\n  input: {\n    width: '100%',\n    padding: '12px 16px',\n    fontSize: '1rem',\n    border: '1px solid #d2d2d7',\n    borderRadius: '8px',\n    boxSizing: 'border-box',\n    transition: 'border-color 0.2s'\n  },\n  payButton: {\n    width: '100%',\n    padding: '16px',\n    backgroundColor: '#0071e3',\n    color: '#fff',\n    border: 'none',\n    borderRadius: '8px',\n    fontSize: '1.2rem',\n    fontWeight: '600',\n    cursor: 'pointer',\n    marginTop: '10px',\n    transition: 'background-color 0.2s',\n    boxShadow: '0 2px 8px rgba(0,113,227,0.3)'\n  },\n  payButtonDisabled: {\n    width: '100%',\n    padding: '16px',\n    backgroundColor: '#ccc',\n    color: '#666',\n    border: 'none',\n    borderRadius: '8px',\n    fontSize: '1.2rem',\n    fontWeight: '600',\n    cursor: 'not-allowed',\n    marginTop: '10px'\n  },\n  stepIndicator: {\n    backgroundColor: '#e3f2fd',\n    padding: '12px',\n    borderRadius: '8px',\n    marginBottom: '16px',\n    fontSize: '0.95rem',\n    color: '#1976d2',\n    textAlign: 'center',\n    fontWeight: '600'\n  },\n  securityNote: {\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    gap: '8px',\n    marginTop: '20px',\n    padding: '12px',\n    backgroundColor: '#f5f5f7',\n    borderRadius: '8px'\n  },\n  lockIcon: {\n    fontSize: '1.2rem'\n  },\n  securityText: {\n    fontSize: '0.9rem',\n    color: '#86868b'\n  },\n  apiLoggerContainer: {\n    marginTop: '20px'\n  }\n};\n\n// Add keyframe animation for spinner\nconst styleSheet = document.createElement(\"style\");\nstyleSheet.textContent = `\n  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n  }\n`;\ndocument.head.appendChild(styleSheet);\nexport default CreditCardDetails;\nvar _c;\n$RefreshReg$(_c, \"CreditCardDetails\");","map":{"version":3,"names":["React","useRef","useState","useEffect","axios","ApiLogger","apiLogManager","jsxDEV","_jsxDEV","CreditCardDetails","message","sendDataToParent","sendDataToParentsessionid","sendDataToParentorderId","sendDataToParenttrxid","onApiLog","_s","cardNumberRef","expiryMonthRef","expiryYearRef","securityCodeRef","cardholderNameRef","showAuthComponent","setShowAuthComponent","sessionId","setSessionId","orderId","setOrderId","transactionId","setTransactionId","merchantConfig","setMerchantConfig","apiLogs","setApiLogs","isLoading","setIsLoading","error","setError","currentStep","setCurrentStep","processingStep","setProcessingStep","sessionCreatedRef","handleApiLog","logEntry","addLog","prev","current","console","log","saved","localStorage","getItem","config","JSON","parse","loadPaymentSessionScript","createPaymentSession","existingScript","document","querySelector","remove","scriptUrl","gatewayUrl","apiVersion","merchantId","script","createElement","src","setAttribute","async","onload","onerror","head","appendChild","requestData","amount","currency","response","post","data","sessionid","orderid","trxid","apiLog","waitForPaymentSession","initiateHostedSession","_error$response","_error$response$data","_error$response2","_error$response2$data","details","callback","attempts","window","PaymentSession","setTimeout","initiateAuthentication","configToUse","authStatus","authenticationStatus","gatewayRecommendation","authenticatePayer","authorizePay","_error$response3","_error$response3$data","_error$response4","_error$response4$data","redirectResponseUrl","location","origin","redirectHtml","_error$response5","_error$response5$data","_error$response6","_error$response6$data","result","gatewayCode","_error$response7","_error$response7$data","_error$response8","_error$response8$data","checkAndInitialize","cardNumber","getElementById","securityCode","expiryMonth","expiryYear","cardholderName","configure","session","fields","card","number","nameOnCard","frameEmbeddingMitigation","callbacks","initialized","status","formSessionUpdate","interaction","displayControl","formatCard","invalidFieldCharacters","handlePayClicked","updateSessionFromForm","style","styles","wrapper","children","container","loadingContainer","spinner","fileName","_jsxFileName","lineNumber","columnNumber","loadingText","errorContainer","errorTitle","errorText","configButton","onClick","href","sessionDetails","sessionTitle","detailRow","detailLabel","detailValue","stepIndicator","errorBanner","heading","formGroup","label","ref","id","type","placeholder","readOnly","input","formRow","payButtonDisabled","payButton","disabled","securityNote","lockIcon","securityText","length","apiLoggerContainer","title","_c","width","maxWidth","margin","backgroundColor","borderRadius","padding","marginBottom","boxShadow","textAlign","border","borderTop","height","animation","color","fontSize","cursor","fontWeight","display","justifyContent","borderBottom","fontFamily","gridTemplateColumns","gap","boxSizing","transition","marginTop","alignItems","styleSheet","textContent","$RefreshReg$"],"sources":["C:/Users/gaura/Downloads/FINAL-hosted-session-with-3DS/final-integrated-version/frontend/src/CreditCardDetails.js"],"sourcesContent":["import React, { useRef, useState, useEffect } from 'react';\nimport axios from 'axios';\nimport ApiLogger from './ApiLogger';\nimport apiLogManager from './utils/ApiLogManager';  // ← ADDED: Import ApiLogManager\n\nconst CreditCardDetails = ({ message, sendDataToParent, sendDataToParentsessionid, sendDataToParentorderId, sendDataToParenttrxid, onApiLog }) => {\n  const cardNumberRef = useRef(null);\n  const expiryMonthRef = useRef(null);\n  const expiryYearRef = useRef(null);\n  const securityCodeRef = useRef(null);\n  const cardholderNameRef = useRef(null);\n  \n  const [showAuthComponent, setShowAuthComponent] = useState(0);\n  const [sessionId, setSessionId] = useState('');\n  const [orderId, setOrderId] = useState('');\n  const [transactionId, setTransactionId] = useState('');\n  const [merchantConfig, setMerchantConfig] = useState(null);\n  const [apiLogs, setApiLogs] = useState([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [currentStep, setCurrentStep] = useState(0); // Track 3DS flow step\n  const [processingStep, setProcessingStep] = useState(''); // Current processing step\n  \n  const sessionCreatedRef = useRef(false); // ← ADDED: Prevent duplicate session creation\n\n  // ← ADDED: API logging handler\n  const handleApiLog = (logEntry) => {\n    apiLogManager.addLog(logEntry);\n    setApiLogs(prev => [...prev, logEntry]);\n  };\n\n  useEffect(() => {\n    // ✅ Prevent duplicate session creation\n    if (sessionCreatedRef.current) {\n      console.log('Session already created, skipping...');\n      return;\n    }\n\n    // Load merchant config\n    const saved = localStorage.getItem('merchantConfig');\n    if (!saved) {\n      setError('Merchant configuration not found. Please configure your merchant details.');\n      setIsLoading(false);\n      return;\n    }\n    \n    const config = JSON.parse(saved);\n    setMerchantConfig(config);\n    \n    // Load Payment Session script dynamically\n    loadPaymentSessionScript(config);\n    \n    // ✅ Mark as created before calling\n    sessionCreatedRef.current = true;\n    \n    // Create payment session\n    createPaymentSession(config);\n  }, []); // ← CHANGED: Empty dependency array to run only once\n\n  const loadPaymentSessionScript = (config) => {\n    // Check if script already exists\n    const existingScript = document.querySelector('script[data-payment-session]');\n    if (existingScript) {\n      existingScript.remove();\n    }\n\n    // Create script URL based on merchant config\n    const scriptUrl = `${config.gatewayUrl}/form/version/${config.apiVersion}/merchant/${config.merchantId}/session.js`;\n    \n    const script = document.createElement('script');\n    script.src = scriptUrl;\n    script.setAttribute('data-payment-session', 'true');\n    script.async = true;\n    \n    script.onload = () => {\n      console.log('Payment Session script loaded successfully');\n    };\n    \n    script.onerror = () => {\n      console.error('Failed to load Payment Session script');\n      setError('Failed to load Payment Session script. Please check your merchant configuration.');\n    };\n    \n    document.head.appendChild(script);\n  };\n\n  const createPaymentSession = async (config) => {\n    // ✅ Check if session already exists\n    if (sessionId) {\n      console.log('Session already exists:', sessionId);\n      return;\n    }\n\n    setIsLoading(true);\n    setError(null);\n    setProcessingStep('Creating session...');\n    \n    try {\n      const requestData = {\n        merchantConfig: config,\n        amount: message,\n        currency: config.currency\n      };\n\n      const response = await axios.post('http://localhost:3001/create-session', requestData);\n      \n      console.log('Session created:', response.data);\n      \n      setSessionId(response.data.sessionid);\n      setOrderId(response.data.orderid);\n      setTransactionId(response.data.trxid);\n      \n      // ← UPDATED: Add API log to both state and ApiLogManager\n      if (response.data.apiLog) {\n        handleApiLog(response.data.apiLog);\n      }\n      \n      // Wait for Payment Session script to be available\n      waitForPaymentSession(() => {\n        // Initialize hosted session - pass merchantConfig\n        initiateHostedSession(response.data.sessionid, response.data.orderid, response.data.trxid, config);\n      });\n      \n      setShowAuthComponent(1);\n      sendDataToParentsessionid(response.data.sessionid);\n      sendDataToParentorderId(response.data.orderid);\n      sendDataToParenttrxid(response.data.trxid);\n      \n      setProcessingStep('');\n      setIsLoading(false);\n    } catch (error) {\n      console.error('Failed to create session:', error);\n      setError(error.response?.data?.details || error.message);\n      \n      // ← UPDATED: Add error log to both state and ApiLogManager\n      if (error.response?.data?.apiLog) {\n        handleApiLog(error.response.data.apiLog);\n      }\n      \n      setProcessingStep('');\n      setIsLoading(false);\n    }\n  };\n\n  const waitForPaymentSession = (callback, attempts = 0) => {\n    if (window.PaymentSession) {\n      callback();\n    } else if (attempts < 50) {\n      // Try again in 100ms (max 5 seconds)\n      setTimeout(() => waitForPaymentSession(callback, attempts + 1), 100);\n    } else {\n      setError('Payment Session script failed to load. Please refresh the page.');\n      setIsLoading(false);\n    }\n  };\n\n  // ============================================\n  // 3DS FLOW - STEP 1: INITIATE AUTHENTICATION\n  // ============================================\n  const initiateAuthentication = async (sessionId, orderId, transactionId, configToUse) => {\n    setProcessingStep('Step 1: Checking 3DS availability...');\n    setCurrentStep(1);\n    \n    try {\n      const requestData = {\n        merchantConfig: configToUse,\n        sessionId,\n        orderId,\n        transactionId\n      };\n\n      console.log('[STEP 1] Initiating authentication...');\n      const response = await axios.post('http://localhost:3001/api/initiate-authentication', requestData);\n      \n      console.log('[STEP 1] Response:', response.data);\n      \n      // ← UPDATED: Add API log to both state and ApiLogManager\n      if (response.data.apiLog) {\n        handleApiLog(response.data.apiLog);\n      }\n\n      const authStatus = response.data.authenticationStatus;\n      const gatewayRecommendation = response.data.gatewayRecommendation;\n\n      console.log('[STEP 1] Auth Status:', authStatus);\n      console.log('[STEP 1] Gateway Recommendation:', gatewayRecommendation);\n\n      // Check if we should proceed to Step 2 (Authenticate Payer)\n      if (authStatus === 'AUTHENTICATION_AVAILABLE' || gatewayRecommendation === 'PROCEED') {\n        console.log('[STEP 1] 3DS available, proceeding to authenticate payer...');\n        await authenticatePayer(sessionId, orderId, transactionId, configToUse);\n      } else if (authStatus === 'AUTHENTICATION_NOT_AVAILABLE') {\n        console.log('[STEP 1] 3DS not available, skipping to payment...');\n        await authorizePay(sessionId, orderId, transactionId, configToUse);\n      } else {\n        console.log('[STEP 1] Proceeding to Step 2 with status:', authStatus);\n        await authenticatePayer(sessionId, orderId, transactionId, configToUse);\n      }\n\n    } catch (error) {\n      console.error('[STEP 1] Error:', error);\n      \n      // ← UPDATED: Add error log to both state and ApiLogManager\n      if (error.response?.data?.apiLog) {\n        handleApiLog(error.response.data.apiLog);\n      }\n      \n      setProcessingStep('');\n      setError(`Step 1 failed: ${error.response?.data?.details || error.message}`);\n    }\n  };\n\n  // ============================================\n  // 3DS FLOW - STEP 2: AUTHENTICATE PAYER\n  // ============================================\n  const authenticatePayer = async (sessionId, orderId, transactionId, configToUse) => {\n    setProcessingStep('Step 2: Authenticating payer...');\n    setCurrentStep(2);\n    \n    try {\n      const requestData = {\n        merchantConfig: configToUse,\n        sessionId,\n        orderId,\n        transactionId,\n        amount: message,\n        redirectResponseUrl: `${window.location.origin}/authentication-callback`\n      };\n\n      console.log('[STEP 2] Authenticating payer...');\n      const response = await axios.post('http://localhost:3001/api/authenticate-payer', requestData);\n      \n      console.log('[STEP 2] Response:', response.data);\n      \n      // ← UPDATED: Add API log to both state and ApiLogManager\n      if (response.data.apiLog) {\n        handleApiLog(response.data.apiLog);\n      }\n\n      const redirectHtml = response.data.redirectHtml;\n      const authStatus = response.data.authenticationStatus;\n\n      console.log('[STEP 2] Auth Status:', authStatus);\n      console.log('[STEP 2] Has redirect HTML:', !!redirectHtml);\n\n      if (redirectHtml) {\n        console.log('[STEP 2] 3DS challenge required, showing authentication frame...');\n        sendDataToParent(redirectHtml);\n        sendDataToParentsessionid(sessionId);\n        sendDataToParentorderId(orderId);\n        sendDataToParenttrxid(transactionId);\n        setProcessingStep('Waiting for 3DS authentication...');\n      } else {\n        console.log('[STEP 2] No 3DS challenge needed, proceeding to payment...');\n        await authorizePay(sessionId, orderId, transactionId, configToUse);\n      }\n\n    } catch (error) {\n      console.error('[STEP 2] Error:', error);\n      \n      // ← UPDATED: Add error log to both state and ApiLogManager\n      if (error.response?.data?.apiLog) {\n        handleApiLog(error.response.data.apiLog);\n      }\n      \n      setProcessingStep('');\n      setError(`Step 2 failed: ${error.response?.data?.details || error.message}`);\n    }\n  };\n\n  // ============================================\n  // 3DS FLOW - STEP 3: AUTHORIZE/PAY\n  // ============================================\n  const authorizePay = async (sessionId, orderId, transactionId, configToUse) => {\n    setProcessingStep('Step 3: Processing payment...');\n    setCurrentStep(3);\n    \n    try {\n      const requestData = {\n        merchantConfig: configToUse,\n        sessionId,\n        orderId,\n        transactionId\n      };\n\n      console.log('[STEP 3] Authorizing payment...');\n      const response = await axios.post('http://localhost:3001/api/authorize-pay', requestData);\n      \n      console.log('[STEP 3] Response:', response.data);\n      \n      // ← UPDATED: Add API log to both state and ApiLogManager\n      if (response.data.apiLog) {\n        handleApiLog(response.data.apiLog);\n      }\n\n      const result = response.data.result;\n      const gatewayCode = response.data.gatewayCode;\n\n      console.log('[STEP 3] Result:', result);\n      console.log('[STEP 3] Gateway Code:', gatewayCode);\n\n      setProcessingStep('');\n\n      if (result === 'SUCCESS') {\n        console.log('[STEP 3] Payment successful!');\n        // Handle success (e.g., redirect to receipt page)\n      } else {\n        console.log('[STEP 3] Payment not successful:', result);\n        setError(`Payment failed: ${result}`);\n      }\n\n    } catch (error) {\n      console.error('[STEP 3] Error:', error);\n      \n      // ← UPDATED: Add error log to both state and ApiLogManager\n      if (error.response?.data?.apiLog) {\n        handleApiLog(error.response.data.apiLog);\n      }\n      \n      setProcessingStep('');\n      setError(`Step 3 failed: ${error.response?.data?.details || error.message}`);\n    }\n  };\n\n  const initiateHostedSession = (sessionId, orderId, transactionId, config) => {\n    // Wait for DOM elements to be ready\n    const checkAndInitialize = (attempts = 0) => {\n      if (attempts > 20) {\n        console.error('Timeout waiting for DOM elements');\n        setError('Failed to initialize payment fields. Please refresh the page.');\n        setIsLoading(false);\n        return;\n      }\n\n      // Check if all required DOM elements exist\n      const cardNumber = document.getElementById('card-number');\n      const securityCode = document.getElementById('security-code');\n      const expiryMonth = document.getElementById('expiry-month');\n      const expiryYear = document.getElementById('expiry-year');\n      const cardholderName = document.getElementById('cardholder-name');\n\n      if (!cardNumber || !securityCode || !expiryMonth || !expiryYear || !cardholderName) {\n        console.log(`Attempt ${attempts + 1}: Waiting for DOM elements...`);\n        setTimeout(() => checkAndInitialize(attempts + 1), 100);\n        return;\n      }\n\n      // DOM elements are ready, now configure Payment Session\n      try {\n        if (!window.PaymentSession) {\n          console.error('PaymentSession not available');\n          setError('Payment Session not loaded. Please refresh the page.');\n          setIsLoading(false);\n          return;\n        }\n\n        console.log('✅ All DOM elements found, configuring Payment Session...');\n        console.log('Configuring Payment Session with session:', sessionId);\n        console.log('Using config:', config ? 'Present' : 'Missing');\n\n        window.PaymentSession.configure({\n          session: sessionId,\n          fields: {\n            card: {\n              number: \"#card-number\",\n              securityCode: \"#security-code\",\n              expiryMonth: \"#expiry-month\",\n              expiryYear: \"#expiry-year\",\n              nameOnCard: \"#cardholder-name\"\n            }\n          },\n          frameEmbeddingMitigation: [\"javascript\"],\n          callbacks: {\n            initialized: function (response) {\n              console.log('Payment session initialized successfully:', response);\n              \n              if (response.status === 'system_error' || response.status === 'fields_in_error') {\n                console.error('Payment Session initialization error:', response);\n                setError(`Payment field error: ${response.message || 'Unknown error'}`);\n                setIsLoading(false);\n              }\n            },\n            formSessionUpdate: function (response) {\n              console.log('Form session updated, starting 3DS flow...', response);\n              \n              if (response.status === 'ok' && response.session) {\n                // Start the 3DS flow\n                initiateAuthentication(sessionId, orderId, transactionId, config);\n              } else if (response.status === 'system_error' || response.status === 'request_timeout') {\n                console.error('Form session update error:', response);\n                setError(`Session update failed: ${response.message || response.status}`);\n                setProcessingStep('');\n              } else {\n                console.error('Invalid form session update response:', response);\n                setError('Failed to update session. Please try again.');\n                setProcessingStep('');\n              }\n            }\n          },\n          interaction: {\n            displayControl: {\n              formatCard: \"EMBOSSED\",\n              invalidFieldCharacters: \"REJECT\"\n            }\n          }\n        });\n      } catch (error) {\n        console.error('Error configuring Payment Session:', error);\n        setError('Failed to configure payment session. Please try again.');\n        setIsLoading(false);\n      }\n    };\n\n    // Start checking for DOM elements\n    checkAndInitialize();\n  };\n\n  const handlePayClicked = () => {\n    if (window.PaymentSession) {\n      window.PaymentSession.updateSessionFromForm('card');\n    } else {\n      setError('Payment session not initialized. Please refresh the page.');\n    }\n  };\n\n  // Loading state\n  if (isLoading) {\n    return (\n      <div style={styles.wrapper}>\n        <div style={styles.container}>\n          <div style={styles.loadingContainer}>\n            <div style={styles.spinner}></div>\n            <p style={styles.loadingText}>{processingStep || 'Initializing payment...'}</p>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  // Error state\n  if (error && !sessionId) {\n    return (\n      <div style={styles.wrapper}>\n        <div style={styles.container}>\n          <div style={styles.errorContainer}>\n            <h3 style={styles.errorTitle}>Configuration Error</h3>\n            <p style={styles.errorText}>{error}</p>\n            <button \n              style={styles.configButton}\n              onClick={() => window.location.href = '/config'}\n            >\n              Go to Configuration\n            </button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div style={styles.wrapper}>\n      {/* Session Details */}\n      {sessionId && (\n        <div style={styles.sessionDetails}>\n          <h3 style={styles.sessionTitle}>Session Information</h3>\n          <div style={styles.detailRow}>\n            <span style={styles.detailLabel}>Session ID:</span>\n            <code style={styles.detailValue}>{sessionId}</code>\n          </div>\n          <div style={styles.detailRow}>\n            <span style={styles.detailLabel}>Order ID:</span>\n            <code style={styles.detailValue}>{orderId}</code>\n          </div>\n          <div style={styles.detailRow}>\n            <span style={styles.detailLabel}>Transaction ID:</span>\n            <code style={styles.detailValue}>{transactionId}</code>\n          </div>\n        </div>\n      )}\n\n      {/* Payment Form */}\n      <div style={styles.container}>\n        {processingStep && (\n          <div style={styles.stepIndicator}>\n            {processingStep}\n          </div>\n        )}\n\n        {error && (\n          <div style={styles.errorBanner}>\n            ⚠️ {error}\n          </div>\n        )}\n\n        <h2 style={styles.heading}>Payment Details</h2>\n\n        <div style={styles.formGroup}>\n          <label style={styles.label}>Card Number</label>\n          <input\n            ref={cardNumberRef}\n            id=\"card-number\"\n            type=\"text\"\n            placeholder=\"1234 5678 9012 3456\"\n            readOnly\n            style={styles.input}\n          />\n        </div>\n\n        <div style={styles.formRow}>\n          <div style={styles.formGroup}>\n            <label style={styles.label}>Expiry Month</label>\n            <input\n              ref={expiryMonthRef}\n              id=\"expiry-month\"\n              type=\"text\"\n              placeholder=\"MM\"\n              readOnly\n              style={styles.input}\n            />\n          </div>\n          \n          <div style={styles.formGroup}>\n            <label style={styles.label}>Expiry Year</label>\n            <input\n              ref={expiryYearRef}\n              id=\"expiry-year\"\n              type=\"text\"\n              placeholder=\"YY\"\n              readOnly\n              style={styles.input}\n            />\n          </div>\n        </div>\n\n        <div style={styles.formGroup}>\n          <label style={styles.label}>Security Code</label>\n          <input\n            ref={securityCodeRef}\n            id=\"security-code\"\n            type=\"text\"\n            placeholder=\"123\"\n            readOnly\n            style={styles.input}\n          />\n        </div>\n\n        <div style={styles.formGroup}>\n          <label style={styles.label}>Cardholder Name</label>\n          <input\n            ref={cardholderNameRef}\n            id=\"cardholder-name\"\n            type=\"text\"\n            placeholder=\"John Doe\"\n            readOnly\n            style={styles.input}\n          />\n        </div>\n\n        <button \n          style={processingStep ? styles.payButtonDisabled : styles.payButton} \n          onClick={handlePayClicked}\n          disabled={!!processingStep}\n        >\n          {processingStep ? 'Processing...' : `Pay $${message} ${merchantConfig?.currency}`}\n        </button>\n\n        <div style={styles.securityNote}>\n          <span style={styles.lockIcon}>🔒</span>\n          <span style={styles.securityText}>Secured by Mastercard Payment Gateway</span>\n        </div>\n      </div>\n\n      {/* API Logs */}\n      {apiLogs.length > 0 && (\n        <div style={styles.apiLoggerContainer}>\n          <ApiLogger apiLogs={apiLogs} title=\"API Call Logs\" />\n        </div>\n      )}\n    </div>\n  );\n};\n\nconst styles = {\n  wrapper: {\n    width: '100%',\n    maxWidth: '800px',\n    margin: '0 auto',\n  },\n  container: {\n    backgroundColor: '#fff',\n    borderRadius: '12px',\n    padding: '30px',\n    marginBottom: '20px',\n    boxShadow: '0 2px 12px rgba(0,0,0,0.08)',\n  },\n  loadingContainer: {\n    textAlign: 'center',\n    padding: '40px',\n  },\n  spinner: {\n    border: '3px solid #f3f3f3',\n    borderTop: '3px solid #0071e3',\n    borderRadius: '50%',\n    width: '40px',\n    height: '40px',\n    animation: 'spin 1s linear infinite',\n    margin: '0 auto 20px',\n  },\n  loadingText: {\n    color: '#86868b',\n    fontSize: '1rem',\n  },\n  errorContainer: {\n    textAlign: 'center',\n    padding: '40px',\n  },\n  errorTitle: {\n    color: '#ff3b30',\n    fontSize: '1.5rem',\n    marginBottom: '16px',\n  },\n  errorText: {\n    color: '#1d1d1f',\n    fontSize: '1rem',\n    marginBottom: '24px',\n  },\n  errorBanner: {\n    backgroundColor: '#fff5f5',\n    color: '#ff3b30',\n    padding: '12px 16px',\n    borderRadius: '8px',\n    marginBottom: '20px',\n    border: '1px solid #ffdddd',\n  },\n  configButton: {\n    padding: '12px 24px',\n    backgroundColor: '#0071e3',\n    color: '#fff',\n    border: 'none',\n    borderRadius: '8px',\n    fontSize: '1rem',\n    cursor: 'pointer',\n  },\n  sessionDetails: {\n    backgroundColor: '#f5f5f7',\n    borderRadius: '12px',\n    padding: '20px',\n    marginBottom: '20px',\n  },\n  sessionTitle: {\n    fontSize: '1.1rem',\n    fontWeight: '600',\n    color: '#1d1d1f',\n    marginBottom: '16px',\n  },\n  detailRow: {\n    display: 'flex',\n    justifyContent: 'space-between',\n    padding: '8px 0',\n    borderBottom: '1px solid #e5e5e7',\n  },\n  detailLabel: {\n    fontSize: '0.9rem',\n    color: '#86868b',\n    fontWeight: '500',\n  },\n  detailValue: {\n    fontSize: '0.85rem',\n    fontFamily: 'Monaco, Courier, monospace',\n    backgroundColor: '#fff',\n    padding: '4px 8px',\n    borderRadius: '4px',\n    color: '#1d1d1f',\n  },\n  heading: {\n    fontSize: '1.5rem',\n    fontWeight: '600',\n    color: '#1d1d1f',\n    marginBottom: '24px',\n    textAlign: 'center',\n  },\n  formGroup: {\n    marginBottom: '20px',\n  },\n  formRow: {\n    display: 'grid',\n    gridTemplateColumns: '1fr 1fr',\n    gap: '16px',\n  },\n  label: {\n    display: 'block',\n    fontSize: '0.95rem',\n    fontWeight: '500',\n    color: '#1d1d1f',\n    marginBottom: '8px',\n  },\n  input: {\n    width: '100%',\n    padding: '12px 16px',\n    fontSize: '1rem',\n    border: '1px solid #d2d2d7',\n    borderRadius: '8px',\n    boxSizing: 'border-box',\n    transition: 'border-color 0.2s',\n  },\n  payButton: {\n    width: '100%',\n    padding: '16px',\n    backgroundColor: '#0071e3',\n    color: '#fff',\n    border: 'none',\n    borderRadius: '8px',\n    fontSize: '1.2rem',\n    fontWeight: '600',\n    cursor: 'pointer',\n    marginTop: '10px',\n    transition: 'background-color 0.2s',\n    boxShadow: '0 2px 8px rgba(0,113,227,0.3)',\n  },\n  payButtonDisabled: {\n    width: '100%',\n    padding: '16px',\n    backgroundColor: '#ccc',\n    color: '#666',\n    border: 'none',\n    borderRadius: '8px',\n    fontSize: '1.2rem',\n    fontWeight: '600',\n    cursor: 'not-allowed',\n    marginTop: '10px',\n  },\n  stepIndicator: {\n    backgroundColor: '#e3f2fd',\n    padding: '12px',\n    borderRadius: '8px',\n    marginBottom: '16px',\n    fontSize: '0.95rem',\n    color: '#1976d2',\n    textAlign: 'center',\n    fontWeight: '600',\n  },\n  securityNote: {\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    gap: '8px',\n    marginTop: '20px',\n    padding: '12px',\n    backgroundColor: '#f5f5f7',\n    borderRadius: '8px',\n  },\n  lockIcon: {\n    fontSize: '1.2rem',\n  },\n  securityText: {\n    fontSize: '0.9rem',\n    color: '#86868b',\n  },\n  apiLoggerContainer: {\n    marginTop: '20px',\n  },\n};\n\n// Add keyframe animation for spinner\nconst styleSheet = document.createElement(\"style\");\nstyleSheet.textContent = `\n  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n  }\n`;\ndocument.head.appendChild(styleSheet);\n\nexport default CreditCardDetails;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}